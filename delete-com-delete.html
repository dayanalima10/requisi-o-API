<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaçoes com APIs |Delete com Delete</title>
</head>

<body>

    <header>
        <a href="./">Home</a>
        <h1> Delete com Delete</h1>
    </header>
    <div id="listaProdutos">

    </div>
    <script src="./scripts/estilos.js"></script>
    <script type="module" src="./scripts/delete-com-delete.js"></script>

    <script>

        // document.addEventListener('click', () => {
        //     if (event.target.classList.contains('delete-button')){
        //         fetch(´http://localhost:3002/produtos/$(event.target.value}´, {
        //             method: 'DELETE',
        //             headers: {
        //                 'Content-type': 'application/json'
        //             }
        //         })
        //                 .then(resposta => {
        //                     if (respósta.ok){
        //                         alert('Produto apagado!');
        //                         location.reload();
        //                     }
        //                 })
        //             }
        //         });


                    fetch('http://localhost:3002/produtos', {
                        method: 'GET',
                        headers: {
                            'Content-type': 'application/json'
            }
                    })
            .then(resposta => resposta.json())
                        .then(resposta => {

                            for (let i = 0; i < resposta.length; i++) {

                                const ul = document.createElement('ul');
                                ul.classList.add('produto');

                                ul.appendChild(document.createElement('li')).
                                    innerHTML = resposta[i].id;
                                ul.appendChild(document.createElement('li')).
                                    innerHTML = resposta[i].descricao;
                                ul.appendChild(document.createElement('li')).
                                    innerHTML = resposta[i].preco;

                                const liDelete = document.createElement('li');
                                const btDelete = document.createElement('button');
                                btDelete.innerHTML = 'X';
                                btDelete.value = resposta[i].id;
                                // btDelete.style.color = 'red';
                                btDelete.classList.add('delete-button');


                                ul.appendChild(liDelete).appendChild(btDelete);


                                document.querySelector('#listaProdutos').appendChild
                                    (ul);


                            }

                        })
    </script>

</body>

</html>